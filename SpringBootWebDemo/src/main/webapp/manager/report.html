<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>项目申报</title>
	<link rel="stylesheet" href="../public/css/reset.css">
	<link rel="stylesheet" href="../public/css/report.css">
</head>
<body>
	<header>
		<div class="header-top-bar">
			
			<div class="container">
				<nav>
					<ul class="nav-ul">
						<li class="pull-left"><a href="index.html">首页</a></li>			
						<li class="pull-left"><a href="policy.html">科技时政</a></li>
						<li class="pull-left"><a href="notice.html">通知公告</a></li>
						<li class="pull-left"><a href="achievements.html">科研成果</a></li>
						<li class="pull-left"><a href="project.html">科研项目</a></li>
						<li class="pull-left"><a href="info.html">了解我们</a></li>
					</ul>
				</nav>
				<div class="pull-right log" id="log">
					<span>管理员：</span><a href="javascript:;" id="name"></a><img src="../public/images/sanjiao.png" alt="">
					
					<div class="box" id="box">
						<ul>
							<li><a href="report.html">申报项目</a></li>
							<li><a href="myproject.html">我的科研项目</a></li>
							<li><span></span></li>
							<li><a href="user_manager.html">用户管理</a></li>
							<li><a href="review_items.html">审核项目</a></li>
							<li><a href="platform_manager.html">平台内容管理</a></li>
							<li><span></span></li>
							<li><a href="">修改密码</a></li>
							<li><a href="/login.html">注销</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>

		<div class="head">
			<div class="container">
				<div class="head-title"><p>项目申报</p></div>
			</div>
		</div>
	</header>
	<div class="content container">
		<form action="/project/" id="researchProjectInsertForm" enctype="multipart/form-data" method="POST">
			<div class="form-group">
				<label for="project-name">项目名称：</label>
				<input type="text" name="title" class="form-control text" id="project-name" placeholder="name...">
			</div>
			<div class="form-group">
				<label for="project-introduce" class="area">项目简介：</label>
				<textarea name="" name="summary" class="form-control" id="project-introduce" placeholder="简介........" rows="10" cols="80"></textarea>
			</div>
			<div class="form-group">
				<label for="project-declare-name">项目申报人：</label>
				<input type="text" name="applicant" class="form-control text" id="project-declare-name" placeholder="name..">
			</div>
			<div class="form-group">
				<label for="project-declare-company">项目申报单位：</label>
				<input type="text" name="declareUnits" class="form-control text" id="project-declare-company" placeholder="company...">
			</div>
			<div class="form-group">
				<label for="project-remark" class="area">备注：</label>
				<textarea name="remark" class="form-control" id="project-remark" placeholder="备注......." rows="10" cols="80"></textarea>
			</div>

			<div class="form-group">
				<label for="inputFile">项目文件上传：</label>
				<input type="file" name="projectFile" id="inputFile">
			</div>

			<<button type="button" onclick="research_project_insert()" class="btn pull-right">申报</button>

		</form>

	</div>
	<footer>
		<div class="href-1 ">
			<p>友情链接</p>
		</div>
		<div class="foot-1">

		</div>
	</footer>



	<script type="application/javascript" src="/js/bootstrap.min.js"></script>
	<script type="application/javascript" src="/js/jquery.min.js"></script>
	<script type="application/javascript" src="/js/jquery.cookie.js"></script>
	<script type="application/javascript" src="/js/ajaxfileupload.js"></script>

	<script>
		document.write( "<script language=javascript src='../public/js/box.js'><\/script>");
		window.onload=function(){
			$("#name").text($.cookie("user_name"));
		}

		function research_project_insert(){
			var userId = $.cookie("user_id");
			var title =$("#project-name").val();
			var summary = $("#project-introduce").val();
			var applicant = $("#project-declare-name").val();
			var declareUnits = $("#project-declare-company").val();
			var remark = $("#project-remark").val();
			var inputFile = $("#inputFile").val();

			if(userId == null || userId.length == 0 || inputFile == null || inputFile.length == 0 || title == null || title.length == 0 || summary == null || summary.length == 0 || applicant == null || applicant.length == 0
					|| declareUnits == null || declareUnits.length == 0 || remark == null || remark.length == 0) {
				alert("所输入参数不能为空!");
			} else {
				$.ajaxFileUpload({
							url:'http://127.0.0.1/project/add?title='+title+'&summary='+summary+'&applicant='+applicant+'&declareUnits='+declareUnits+'&remark='+remark+"&userId="+userId,
							type:'POST',
							secureuri: false, //是否需要安全协议，一般设置为false
							dataType: 'json', //返回值类型 一般设置为json
							fileElementId:'inputFile',
							success: function (data, status){
								if(data != null) {
									alert("申报成功!")
									//1秒后执行
									setTimeout( function(){
										location.href="/manager/myproject.html";
									}, 1 * 1000 );
								} else {
									alert("申报失败!")
								}
							},
							error: function (data, status, e)//服务器响应失败处理函数
							{
								alert("error!");
							}

						}
				);
				if(title == null || title.length == 0 || summary == null || summary.length == 0 || applicant == null || applicant.length == 0
						|| declareUnits == null || declareUnits.length == 0 || remark == null || remark.length == 0) {

				} else {
					alert("申报成功!")
					location.href="myproject.html";
				}
			}





		}

	</script>
</body>
</html>